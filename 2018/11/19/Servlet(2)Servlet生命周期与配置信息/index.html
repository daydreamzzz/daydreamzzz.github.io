<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    <title>JavaWeb开发学习笔记之Servlet（二） Servlet生命周期与配置信息 | 自言自语</title>
    
    
        <meta name="keywords" content="前端,Java Web,servlet">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="创建Servlet对象的过程 当Servlet容器启动时，会首先读取web.xml配置文件的信息，构造指定的Servlet对象，创建ServletConfig对象，同时将ServletConfig对象作为参数来调用Servlet对象的init方法。 在Servlet容器启动后：客户首次向Servlet发出请求，Servlet容器会判断内存中是否存在指定的Servlet对象，如果没有则创建它，然后根">
<meta name="keywords" content="前端,Java Web,servlet">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaWeb开发学习笔记之Servlet（二） Servlet生命周期与配置信息">
<meta property="og:url" content="http://yoursite.com/2018/11/19/Servlet(2)Servlet生命周期与配置信息/index.html">
<meta property="og:site_name" content="自言自语">
<meta property="og:description" content="创建Servlet对象的过程 当Servlet容器启动时，会首先读取web.xml配置文件的信息，构造指定的Servlet对象，创建ServletConfig对象，同时将ServletConfig对象作为参数来调用Servlet对象的init方法。 在Servlet容器启动后：客户首次向Servlet发出请求，Servlet容器会判断内存中是否存在指定的Servlet对象，如果没有则创建它，然后根">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://i.imgur.com/BgE68ab.png">
<meta property="og:image" content="https://i.imgur.com/JnZTdcW.png">
<meta property="og:image" content="https://i.imgur.com/i9D4LGW.png">
<meta property="og:updated_time" content="2019-12-15T14:14:47.431Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaWeb开发学习笔记之Servlet（二） Servlet生命周期与配置信息">
<meta name="twitter:description" content="创建Servlet对象的过程 当Servlet容器启动时，会首先读取web.xml配置文件的信息，构造指定的Servlet对象，创建ServletConfig对象，同时将ServletConfig对象作为参数来调用Servlet对象的init方法。 在Servlet容器启动后：客户首次向Servlet发出请求，Servlet容器会判断内存中是否存在指定的Servlet对象，如果没有则创建它，然后根">
<meta name="twitter:image" content="https://i.imgur.com/BgE68ab.png">
    

    
        <link rel="alternate" href="/atom.xml" title="自言自语" type="application/atom+xml">
    

    
        <link rel="icon" href="/favicon.ico">
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">
    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
</head>
</html>
<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">自言自语</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id='categories'>
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id='allExpand' href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree" > 
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            技术开发
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Java
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            JDBC
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2018/09/21/JDBC获取元数据/">使用Java获取JDBC元数据对象</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Java8
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2018/02/27/Java8函数式编程/">java8函数式编程</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            JavaWeb
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Servlet
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2018/11/12/Servlet(1) Servlet与Servlet容器的概念/">JavaWeb开发学习笔记之Servlet（一） Servlet与Servlet容器的概念</a></li>  <li class="file active"><a href="/2018/11/19/Servlet(2)Servlet生命周期与配置信息/">JavaWeb开发学习笔记之Servlet（二） Servlet生命周期与配置信息</a></li>  <li class="file"><a href="/2018/11/21/Servlet(3)Cookie与Session, 及Servlet线程安全问题/">JavaWeb开发学习笔记之Servlet（三） Cookie与Session, 及Servlet线程安全问题</a></li>  <li class="file"><a href="/2018/11/21/Servlet(4)Filter与Listener/">JavaWeb开发学习笔记之Servlet（四） Filter与Listener</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2018/03/08/使用iframe下载文件/">使用iframe下载文件</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Java图形化
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Swing
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2018/09/13/swing布局/">Swing布局</a></li>  <li class="file"><a href="/2018/09/15/swing右键添加菜单/">swing中添加右键菜单</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            ORM
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Hibernate
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2020/01/17/Hibernate学习（一）/">Hibernate学习（一）</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            服务器
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Tomcat
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2018/11/28/Tomcat学习笔记(1) Tomcat简介及启动信息/">Tomcat学习笔记(1) Tomcat简介及启动信息</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            生活学习
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            英语
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2018/08/28/Dream/">Dream</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2020/01/18/2019年总结/">2019年总结</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2019/12/15/index/">自言自语</a></li>  </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-Servlet(2)Servlet生命周期与配置信息" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/技术开发/">技术开发</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术开发/Java/">Java</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术开发/Java/JavaWeb/">JavaWeb</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/技术开发/Java/JavaWeb/Servlet/">Servlet</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Java-Web/">Java Web</a>, <a class="tag-link" href="/tags/servlet/">servlet</a>, <a class="tag-link" href="/tags/前端/">前端</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2018/11/19/Servlet(2)Servlet生命周期与配置信息/">
            <time datetime="2018-11-19T15:13:02.000Z" itemprop="datePublished">2018-11-19</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a href='https://github.com/zthxxx/Wiki-site/raw/writing/source/_posts/Servlet(2)Servlet生命周期与配置信息.md'> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/zthxxx/Wiki-site/edit/writing/source/_posts/Servlet(2)Servlet生命周期与配置信息.md'> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/zthxxx/Wiki-site/commits/writing/source/_posts/Servlet(2)Servlet生命周期与配置信息.md'> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            JavaWeb开发学习笔记之Servlet（二） Servlet生命周期与配置信息
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
        
        
            <h1 id="创建Servlet对象的过程"><a href="#创建Servlet对象的过程" class="headerlink" title="创建Servlet对象的过程"></a>创建Servlet对象的过程</h1><ul>
<li>当Servlet容器启动时，会首先读取web.xml配置文件的信息，构造指定的Servlet对象，创建ServletConfig对象，同时将ServletConfig对象作为参数来调用Servlet对象的init方法。</li>
<li>在Servlet容器启动后：客户首次向Servlet发出请求，Servlet容器会判断内存中是否存在指定的Servlet对象，如果没有则创建它，然后根据客户的请求创建HttpRequest、HttpResponse对象，从而调用Servlet 对象的service方法。</li>
<li>Servlet容器在启动时自动创建Servlet，这是由在web.xml文件中为Servlet设置的<strong>&lt;load-on-startup&gt;</strong>属性决定的。从中我们也能看到同一个类型的Servlet对象在Servlet容器中以单例的形式存在。web.xml配置如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;Init&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-class&gt;org.xl.servlet.InitServlet&lt;/servlet-class&gt;</span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>关于<strong>&lt;load-on-startup&gt;</strong>的含义是， 标记容器是否在启动的时候就加载这个servlet； 当是一个负数或者未指定时，则指示容器在该servlet被选择时才加载。 正数的值越小，启动该servlet的优先级越高</li>
</ul>
<h1 id="如何创建配置Servlet"><a href="#如何创建配置Servlet" class="headerlink" title="如何创建配置Servlet"></a>如何创建配置Servlet</h1><p>关于Servlet的创建于使用我们需要两个实现要步</p>
<ol>
<li>创建一个java类，继承HttpServlet类。 当然，根据JAVA的类继承顺序，我们也可以对HttpServlet的父类进行操作，但是继承HttpServlet类是最常见的，因为HttpServlet类帮我们内部实现了一部分方法，无需我们手动再进行实现</li>
<li>配置web.xml文件</li>
</ol>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line"></span><br><span class="line">public class HelloServlet extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void init() throws ServletException &#123;</span><br><span class="line">		System.out.println(&quot;init....&quot;);</span><br><span class="line">		 // Servlet初始化</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class="line">		System.out.println(&quot;进入Service方法&quot;);</span><br><span class="line">		// 实际进行业务逻辑处理的地方</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void destroy() &#123;</span><br><span class="line">		System.out.println(&quot;destroy....&quot;);</span><br><span class="line">		 // Servlet销毁</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在web.xml配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;servlet-class&gt;cn.hel.util.HelloServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/hello&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">// &lt;servlet&gt;用于注册Servlet，包含了&lt;servlet-name&gt;和&lt;servlet-class&gt;两个子元素，分别用于设置servlet的名称以及servlet的类名。</span><br><span class="line">// &lt;servlet-mapping&gt;用于映射上面&lt;servlet&gt;中的对外访问路径，同样包含&lt;servlet-name&gt;和&lt;url-pattern&gt;两个元素，分别用于设置servlet的名称以及servlet的对外访问路径。</span><br></pre></td></tr></table></figure></p>
<p>测试启动与发送请求，输出：</p>
<p><img src="https://i.imgur.com/BgE68ab.png" alt></p>
<h1 id="Servlet的生命周期"><a href="#Servlet的生命周期" class="headerlink" title="Servlet的生命周期"></a>Servlet的生命周期</h1><p>关于Servlet的生命周期，在上面的例子中其实也可以看到。servlet的声明周期主要围绕三个方法进行，init(), service(), destroy(), 关于这三个方法的说明如下。</p>
<ul>
<li>init()，Servlet初始化时调用，只执行一次</li>
<li>service(), 直接处理业务逻辑请求的方法</li>
<li>destroy(), Servlet生命周期结束时调用，进行销毁。只执行一次</li>
</ul>
<h1 id="ServletConfig"><a href="#ServletConfig" class="headerlink" title="ServletConfig"></a>ServletConfig</h1><p>ServletConfig主要用于加载Servlet的初始化参数,在一个web应用可以存在多个ServletConfig对象。</p>
<p><img src="https://i.imgur.com/JnZTdcW.png" alt></p>
<p>ServletConfig主要包含四个方法</p>
<ul>
<li>String getServletName()  – 获取当前Servlet在web.xml中配置的名字</li>
<li>String getInitParameter(String name) – 获取当前Servlet指定名称的初始化参数的值</li>
<li>Enumeration getInitParameterNames()  – 获取当前Servlet所有初始化参数的名字组成的枚举</li>
<li>ServletContext getServletContext()  – 获取代表当前web应用的ServletContext对象</li>
</ul>
<h2 id="ServletConfig获取基本配置信息"><a href="#ServletConfig获取基本配置信息" class="headerlink" title="ServletConfig获取基本配置信息"></a>ServletConfig获取基本配置信息</h2><p>在Servlet的配置文件中，可以使用一个或多个<init-param>标签为servlet配置一些初始化参数。（配置在某个 servlet标签）当servlet配置了初始化参数后，web容器在创建servlet实例对象时，会自动将这些初始化参数 封装到ServletConfig对象中，并在调用servlet的init方法时，将ServletConfig对象传递给servlet,因此通过ServletConfig对象就可以得到当前servlet的初始化参数信息。</init-param></p>
<p><strong>ServletConfig代表的是Servlet在web.xml中的配置信息,对应web.xml中的Servlet元素</strong></p>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;servlet-class&gt;cn.hel.util.HelloServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">	&lt;!--配置HelloServlet的初始化参数 --&gt;</span><br><span class="line">	&lt;init-param&gt;</span><br><span class="line">		&lt;param-name&gt;name&lt;/param-name&gt;</span><br><span class="line">		&lt;param-value&gt;gacl&lt;/param-value&gt;</span><br><span class="line">	&lt;/init-param&gt;</span><br><span class="line">	&lt;init-param&gt;</span><br><span class="line">		&lt;param-name&gt;password&lt;/param-name&gt;</span><br><span class="line">		&lt;param-value&gt;123&lt;/param-value&gt;</span><br><span class="line">	&lt;/init-param&gt;</span><br><span class="line">	&lt;init-param&gt;</span><br><span class="line">		&lt;param-name&gt;charset&lt;/param-name&gt;</span><br><span class="line">		&lt;param-value&gt;UTF-8&lt;/param-value&gt;</span><br><span class="line">	&lt;/init-param&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">	&lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/hello&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>在HttpServlet中获取.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class HelloServlet extends HttpServlet &#123;</span><br><span class="line">	</span><br><span class="line">	@Override</span><br><span class="line">	public void init() throws ServletException &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class="line">		System.out.println(&quot;======进入Service方法========&quot;);</span><br><span class="line">		</span><br><span class="line">		ServletConfig config = this.getServletConfig();</span><br><span class="line">		</span><br><span class="line">		System.out.println(&quot;ServletName: &quot;+config.getServletName());</span><br><span class="line">		//获取在web.xml中配置的初始化参数</span><br><span class="line">        String paramVal = config.getInitParameter(&quot;name&quot;);//获取指定的初始化参数</span><br><span class="line">        System.out.println(paramVal);</span><br><span class="line">        </span><br><span class="line">        //获取所有的初始化参数</span><br><span class="line">        Enumeration&lt;String&gt; e = config.getInitParameterNames();</span><br><span class="line">        while(e.hasMoreElements())&#123;</span><br><span class="line">            String name = e.nextElement();</span><br><span class="line">            String value = config.getInitParameter(name);</span><br><span class="line">            System.out.println(name + &quot;=&quot; + value);</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void destroy() &#123;</span><br><span class="line">		System.out.println(&quot;destroy....&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出：</p>
<p><img src="https://i.imgur.com/i9D4LGW.png" alt></p>
<p>我们如果是用IDE工具进行调试的话（此处我用的是Eclipse+Tomcat），其实可以看到我们获取的ServletConfig对象，本身都是一个<a href="https://tomcat.apache.org/tomcat-6.0-doc/api/org/apache/catalina/core/StandardWrapperFacade.html" target="_blank" rel="noopener">org.apache.catalina.core.StandardWrapperFacade</a>类对象，来源于Tomcat容器。针对这一点，在以后tomcat的笔记中再进行详细研究。</p>
<p>关于Servlet的配置， 在servlet3.0以上的版本中增加了注解配置，无需继续在web.xml中进行配置，直接在类上使用@WebServlet注解即可，例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@WebServlet(name = &quot;hello&quot;, urlPatterns = &#123; &quot;/hello&quot;, &quot;/hello/*&quot; &#125;, loadOnStartup = 1, initParams = &#123;</span><br><span class="line">		@WebInitParam(name = &quot;name&quot;, value = &quot;gacl&quot;), @WebInitParam(name = &quot;password&quot;, value = &quot;123&quot;),</span><br><span class="line">		@WebInitParam(name = &quot;charset&quot;, value = &quot;UTF-8&quot;) &#125;)</span><br><span class="line">public class HelloServlet extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对于@WebServlet注解与web.xml中配置servlet的属性对照，<strong>@WebServlet注解的属性都为可选属性，但是value或者urlPatterns通常是必须存在其中之一，它配置了servlet请求的限定范围，且两个属性不能共存，一般我们是用urlPattern，忽略value属性</strong>。</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>String</td>
<td>指定Servlet的name属性，等价于&lt;servlet-name&gt;。如果没有显式指定，则该 Servlet 的取值即为类的全限定名。</td>
</tr>
<tr>
<td>value</td>
<td>String[]</td>
<td>该属性等价于 urlPatterns 属性。两个属性不能同时使用。</td>
</tr>
<tr>
<td>urlPatterns</td>
<td>String[]</td>
<td>指定一组Servlet的URL匹配模式。等价于&lt;url-pattern&gt;标签。</td>
</tr>
<tr>
<td>loadOnStartup</td>
<td>int</td>
<td>指定Servlet的加载顺序，等价于&lt;load-on-startup&gt;标签。</td>
</tr>
<tr>
<td>initParams</td>
<td>WebInitParam[]</td>
<td>指定一组Servlet初始化参数，等价于&lt;init-param&gt;标签。</td>
</tr>
<tr>
<td>asyncSupported</td>
<td>boolean</td>
<td>声明Servlet是否支持异步操作模式，等价于&lt;async-supported&gt;标签。</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>该Servlet的描述信息，等价于&lt;description&gt;标签。</td>
</tr>
<tr>
<td>displayName</td>
<td>String</td>
<td>该Servlet的显示名，通常配合工具使用，等价于&lt;display-name&gt;标签。</td>
</tr>
</tbody>
</table>
<p>关于initParams的值，它是一个WebInitParam数组，数组中的每一个值由一个@WebInitParam注解进行配置，关于@WebInitParam注解，不光配合@WebServlet中可以使用，在配置过滤器使用@Filter时也可以使用，以下是@WebInitParam的参数说明</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>是否可选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>String</td>
<td>否</td>
<td>指定参数的名字，等价于&lt;param-name&gt;。</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>否</td>
<td>指定参数的值，等价于&lt;param-value&gt;。</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>是</td>
<td>关于参数的描述，等价于&lt;description&gt;。</td>
</tr>
</tbody>
</table>
<h2 id="ServletContext对象"><a href="#ServletContext对象" class="headerlink" title="ServletContext对象"></a><div style="color:#f55302">ServletContext对象</div></h2><h3 id="ServletContext对象的定义"><a href="#ServletContext对象的定义" class="headerlink" title="ServletContext对象的定义"></a>ServletContext对象的定义</h3><p><strong>ServletContext代表的是当前的web应用，是Servlet容器上下文环境对象。</strong>定义一组方法，servlet使用这些方法与其servlet容器进行通信。例如，获取文件的 MIME 类型、分发请求或写入日志文件。每个web应用都有且仅有一个ServletContext对象，这个对象在所有的Servlet都可以使用。</p>
<p>以下为ServletContext源码中对其的定义说明。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Defines a set of methods that a servlet uses to communicate with its</span><br><span class="line"> * servlet container, for example, to get the MIME type of a file, dispatch</span><br><span class="line"> * requests, or write to a log file.</span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;There is one context per &quot;web application&quot; per Java Virtual Machine.  (A</span><br><span class="line"> * &quot;web application&quot; is a collection of servlets and content installed under a</span><br><span class="line"> * specific subset of the server&apos;s URL namespace such as &lt;code&gt;/catalog&lt;/code&gt;</span><br><span class="line"> * and possibly installed via a &lt;code&gt;.war&lt;/code&gt; file.) </span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;In the case of a web</span><br><span class="line"> * application marked &quot;distributed&quot; in its deployment descriptor, there will</span><br><span class="line"> * be one context instance for each virtual machine.  In this situation, the </span><br><span class="line"> * context cannot be used as a location to share global information (because</span><br><span class="line"> * the information won&apos;t be truly global).  Use an external resource like </span><br><span class="line"> * a database instead.</span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;The &lt;code&gt;ServletContext&lt;/code&gt; object is contained within </span><br><span class="line"> * the &#123;@link ServletConfig&#125; object, which the Web server provides the</span><br><span class="line"> * servlet when the servlet is initialized.</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<h3 id="ServletContext对象的获取方式"><a href="#ServletContext对象的获取方式" class="headerlink" title="ServletContext对象的获取方式"></a>ServletContext对象的获取方式</h3><p>在Servlet中获取ServletContext对象可通过以下三种方式获得</p>
<ul>
<li>this.getServletContext();</li>
<li>this.getServletConfig().getServletContext();</li>
<li>request.getSession().getServletContext();</li>
</ul>
<p>三种方式获取的ServletContext对象都为同一个。</p>
<h3 id="ServletContext的作用"><a href="#ServletContext的作用" class="headerlink" title="ServletContext的作用"></a>ServletContext的作用</h3><p>web容器启动时，它为每一个web程序都创建一个对应的ServletContext对象，它代表着当前的web应用，事实上SpringMVC封装的ApplicationContext及Struts2封装的ApplicationContext里面都保存着原本的ServletContext.</p>
<p>ServletConfig获取的是配置在web.xml中的信息，ServletContext可以获取外部资源信息，如常用的properties文件信息。</p>
<p><strong>ServletContext配置的参数，可以被同一web应用下的所有servlet共享</strong>， 也正因此，Servlet对象之间可以通过ServletContext对象进行通讯，ServletContext通常也被称为域对象。</p>
<p>总结ServletContext的作用： Web应用范围内存共享数据；访问web应用的静态资源； Servlet对应之间通过ServletContext对象实现通讯。</p>
<p>例，获取web.xml中配置的上下文初始化参数：</p>
<p>在web.xml配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置context --&gt;</span><br><span class="line">&lt;context-param&gt;</span><br><span class="line">	&lt;param-name&gt;username&lt;/param-name&gt;</span><br><span class="line">	&lt;param-value&gt;zhangsan&lt;/param-value&gt;</span><br><span class="line">&lt;/context-param&gt;</span><br></pre></td></tr></table></figure></p>
<p>在servlet中获取<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ServletContext context = this.getServletContext();</span><br><span class="line">context.getInitParameter(&quot;username&quot;)</span><br><span class="line">// ServletContext中的getInitParameter()和getInitParameterNames()方法与ServletConfig中的用法一致</span><br></pre></td></tr></table></figure></p>
<p>例，获取ServletContext的上下文属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ServletContext context =this.getServletContext();</span><br><span class="line">context.setAttribute(&quot;name&quot;,&quot;value&quot;);</span><br><span class="line">context.getAttribute(&quot;name&quot;);</span><br><span class="line"> </span><br><span class="line">Enumberation p=application.getAttributeNames();</span><br></pre></td></tr></table></figure></p>
<h3 id="ServletContext的主要方法"><a href="#ServletContext的主要方法" class="headerlink" title="ServletContext的主要方法"></a>ServletContext的主要方法</h3><ol>
<li>属性相关，web应用范围内存共享数据</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setAttribute(String name,Object obj): 添加属性</span><br><span class="line">getAttribute(String name): 获取属性，返回Object</span><br><span class="line">removeAttribute(name): 删除属性： </span><br><span class="line">getAttributeNames(), 获取所有属性</span><br></pre></td></tr></table></figure>
<ol>
<li>加载资源文件，访问静态资源</li>
</ol>
<p>getResource(String parh): 获取代表某个资源的url对象，其中，path必须是/开头，代表当前web应用程序的根目录</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">URL url = context.getResource(&quot;/WEB-INF/classes/jdbc.properties&quot;);//得到URL              </span><br><span class="line">InputStream in_url = url.openStream();//直接得到流  </span><br><span class="line">Properties props1 = new Properties(); </span><br><span class="line">props1.load(in_url);//获取资源文件</span><br></pre></td></tr></table></figure>
</code></pre><p>getResoutceAsStream(String parh)，返回文件流。这个好处是可以使用相对于根目录的路径访问到web目录下的所有文件，而不必知道绝对路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">InputStream in = context.getResourceAsStream(&quot;/WEB-INF/classes/jdbc.properties&quot;);  </span><br><span class="line">Properties props = new Properties(); </span><br><span class="line">props.load(in);</span><br></pre></td></tr></table></figure></p>
<h2 id="请求转发与重定向"><a href="#请求转发与重定向" class="headerlink" title="请求转发与重定向"></a>请求转发与重定向</h2><p>请求转发能实现的主要原因是由于ServletContext的数据共享。</p>
<p>关于请求转发与重定向的模式说明，举例，一个人去银行办事，如果柜台的员工无法处理，她叫你等在这里，去叫经理过来处理，那么这就是请求转发， 重定向是，一个人去银行办事，如果柜台的员工无法处理，她说这个业务我们这个网点办理不了，建议去其他网点办理，然后你就去了另外一个网点办理业务，这就是重定向。</p>
<p>请求转发与重定向的区别</p>
<table>
<thead>
<tr>
<th style="text-align:center">类别</th>
<th style="text-align:center">请求转发</th>
<th style="text-align:center">重定向</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">浏览器URL</td>
<td style="text-align:center">原来的url</td>
<td style="text-align:center">新的url</td>
</tr>
<tr>
<td style="text-align:center">请求次数</td>
<td style="text-align:center">1次</td>
<td style="text-align:center">2次</td>
</tr>
<tr>
<td style="text-align:center">跳转范围</td>
<td style="text-align:center">只能请求项目中的资源</td>
<td style="text-align:center">可以跳转到项目外</td>
</tr>
<tr>
<td style="text-align:center">转发</td>
<td style="text-align:center">只能请求项目中的资源</td>
<td style="text-align:center">可以跳转到项目外</td>
</tr>
</tbody>
</table>
<p>请求转发的实现方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RequestDispatcher rd = this.getServletContext().getRequestDispatcher(urlPath);</span><br><span class="line">rd.forward(request, response);</span><br></pre></td></tr></table></figure></p>
<p>重定向<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(urlPath);</span><br></pre></td></tr></table></figure></p>
<h2 id="使用ServletContext动态配置"><a href="#使用ServletContext动态配置" class="headerlink" title="使用ServletContext动态配置"></a>使用ServletContext动态配置</h2><p>在servlet3.0以后的版本中对于ServletContext的性能进行了增强，该对象支持在运行时动态部署Servlet，Filter，Listener,以及为Servlet和Filter增加url映射。</p>
<p>此处我们以Servlet为例，Filter与Listener的与其大同小异。</p>
<p>之前我们说到配置一个servlet有两种方式</p>
<ol>
<li>在web.xml中配置映射</li>
<li>为servlet对象增加@WebServlet注解配置映射</li>
</ol>
<p>在3.0以后的servlet版本中，ServeltContext类中对于Servlet增加了以下几个方法。</p>
<ul>
<li>ServletRegistration.Dynamic addServlet(String servletName, String className);</li>
<li>ServletRegistration.Dynamic addServlet(String servletName, Servlet servlet)</li>
<li>ServletRegistration.Dynamic addServlet(String servletName, String className)</li>
<li><t extends servlet> T createServlet(Class<t> clazz)</t></t></li>
<li>ServletRegistration getServletRegistration(String servletName)</li>
<li>Map&lt;String,? extends ServletRegistration&gt; getServletRegistrations()、</li>
</ul>
<p>关于以上几个方法，前三个重载方法为添加serlvet到注册中心，createServlet动态创建一个servlet, 后两个为获取注册中心ServletRegistration。</p>
<p>ServletRegistration，这个类提供动态注册，像SpringBoot就是通过动态注册servlet到容器。</p>
<p>使用context动态注册新的servlet，是在context初始化时调用。即，在ServletContextListener的contexInitialized()方法中， 或者是在ServletContainerInitializer类中的onStartup()方法中被调用。ServletContainerInitializer是servlet3.0后新增的一个接口</p>
<p>例：</p>
<p>新建一个Servlet类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class DynamicCreateTestServlet extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void service(ServletRequest req, ServletResponse res) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">		System.out.println(&quot;DynamicCreateTestServlet service ......&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在context初始化时动态注册一个新的Servlet<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@WebListener</span><br><span class="line">public class MyServletContextListener implements ServletContextListener &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void contextInitialized(ServletContextEvent sce) &#123;</span><br><span class="line">		System.out.println(&quot;listener init... &quot;);</span><br><span class="line">		</span><br><span class="line">		// 在Listener监听器中获取ServletContext</span><br><span class="line">		ServletContext context = sce.getServletContext();</span><br><span class="line">		HttpServlet servlet;</span><br><span class="line">		try &#123;</span><br><span class="line">			// 创建一个Servlet</span><br><span class="line">			servlet = context.createServlet(DynamicCreateTestServlet.class);</span><br><span class="line">			// 将创建的Servlet添加到注册中心,键为servlet-name, 值为新建的servlet类</span><br><span class="line">			context.addServlet(&quot;testServlet&quot;, servlet);</span><br><span class="line">			// 根据新建的servlet,通过其servlet-name获取对应的注册中心</span><br><span class="line">			ServletRegistration registration = context.getServletRegistration(&quot;testServlet&quot;);</span><br><span class="line">			// 为注册中心增加映射,相当于为新建的servlet增加urlPattern, 值为一个动态String数组</span><br><span class="line">			registration.addMapping(&quot;/dynimcServlet&quot;);</span><br><span class="line">		&#125; catch (ServletException e) &#123;</span><br><span class="line">			System.out.println(&quot;dynamic add servlet fail&quot;);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void contextDestroyed(ServletContextEvent sce) &#123;</span><br><span class="line">		System.out.println(&quot;listener destroy...&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里还有一点，获取注册中心ServletRegistration时除了使用getServletRegistration()方法<br>精确获取某一个ServletRegistration之外<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServletRegistration getServletRegistration(String servletName)</span><br></pre></td></tr></table></figure></p>
<p>也可以使用getServletRegistrations()获取所有注册注册中心<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,? extends ServletRegistration&gt; getServletRegistrations()</span><br></pre></td></tr></table></figure></p>
<p>而我们获取的这个Map打印时，除了我们自己配置的Servlet，还有两个不是我们配置的Servlet， 它们的servlet-name一个叫default,一个叫jsp，这两者来源于我使用的tomcat容器，在后面tomcat的内容中会进行讲述。</p>
<p>参考与引用：</p>
<p><a href="https://www.ibm.com/developerworks/cn/java/j-lo-servlet30/index.html" target="_blank" rel="noopener">IBM developerWorks: Servlet3.0新特性详解——张建平</a></p>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
        <a href="/2018/11/21/Servlet(3)Cookie与Session, 及Servlet线程安全问题/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    JavaWeb开发学习笔记之Servlet（三） Cookie与Session, 及Servlet线程安全问题
                
            </div>
        </a>
    
    
        <a href="/2018/11/12/Servlet(1) Servlet与Servlet容器的概念/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">JavaWeb开发学习笔记之Servlet（一） Servlet与Servlet容器的概念</div>
        </a>
    
</nav>





    
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            John Doe &copy; 2020 
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme - <a href="https://github.com/zthxxx/hexo-theme-Wikitten">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>

        

    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>